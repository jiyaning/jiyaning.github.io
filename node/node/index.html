<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>node | web前端开发</title>
    <meta name="description" content="个人博客">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.46bdbf49.css" as="style"><link rel="preload" href="/assets/js/app.549ab972.js" as="script"><link rel="preload" href="/assets/js/2.ecc2fa6f.js" as="script"><link rel="preload" href="/assets/js/23.cce2bed4.js" as="script"><link rel="prefetch" href="/assets/js/10.4ce75836.js"><link rel="prefetch" href="/assets/js/11.4771b230.js"><link rel="prefetch" href="/assets/js/12.f03499bf.js"><link rel="prefetch" href="/assets/js/13.2c65fd33.js"><link rel="prefetch" href="/assets/js/14.a5be85de.js"><link rel="prefetch" href="/assets/js/15.428dd0c3.js"><link rel="prefetch" href="/assets/js/16.4b3bd144.js"><link rel="prefetch" href="/assets/js/17.0dd718db.js"><link rel="prefetch" href="/assets/js/18.0a392d7a.js"><link rel="prefetch" href="/assets/js/19.a3f55a97.js"><link rel="prefetch" href="/assets/js/20.46e8e003.js"><link rel="prefetch" href="/assets/js/21.9a036560.js"><link rel="prefetch" href="/assets/js/22.4ff0af16.js"><link rel="prefetch" href="/assets/js/24.12c7b7d3.js"><link rel="prefetch" href="/assets/js/25.644b21f7.js"><link rel="prefetch" href="/assets/js/26.ff2f0716.js"><link rel="prefetch" href="/assets/js/27.02ade99e.js"><link rel="prefetch" href="/assets/js/28.57829572.js"><link rel="prefetch" href="/assets/js/29.ca9097ef.js"><link rel="prefetch" href="/assets/js/3.49ef6df2.js"><link rel="prefetch" href="/assets/js/30.98cc88b4.js"><link rel="prefetch" href="/assets/js/31.98cff12d.js"><link rel="prefetch" href="/assets/js/32.de6c6cb5.js"><link rel="prefetch" href="/assets/js/4.e43a75b1.js"><link rel="prefetch" href="/assets/js/5.fffb226e.js"><link rel="prefetch" href="/assets/js/6.f0f6a59d.js"><link rel="prefetch" href="/assets/js/7.fd46d82f.js"><link rel="prefetch" href="/assets/js/8.0a7d41ba.js"><link rel="prefetch" href="/assets/js/9.20648608.js">
    <link rel="stylesheet" href="/assets/css/0.styles.46bdbf49.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">web前端开发</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML" class="dropdown-title"><span class="title">HTML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/html/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/html/html5/" class="nav-link">
  HTML5
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/css/css3/" class="nav-link">
  CSS3
</a></li></ul></div></div><div class="nav-item"><a href="/Flex/" class="nav-link">
  Flex
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JS" class="dropdown-title"><span class="title">JS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/js基础/" class="nav-link">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/js/js高级/" class="nav-link">
  JS高级
</a></li><li class="dropdown-item"><!----> <a href="/js/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/js/正则表达式/" class="nav-link">
  正则
</a></li></ul></div></div><div class="nav-item"><a href="/jquery/" class="nav-link">
  Jquery
</a></div><div class="nav-item"><a href="/Web API/" class="nav-link">
  Web API
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ajax" class="dropdown-title"><span class="title">Ajax</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/ajax/" class="nav-link">
  Ajax
</a></li><li class="dropdown-item"><!----> <a href="/ajax/axios/" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue基础/" class="nav-link">
  vue基础
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue核心/" class="nav-link">
  vue核心
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react基础/" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/react/react核心/" class="nav-link">
  react核心
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/node/" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/node/Express/" class="nav-link">
  Express
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/ .html" class="nav-link">
  mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/HTTP/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/websocket/" class="nav-link">
  webSocket
</a></li><li class="dropdown-item"><!----> <a href="/会话技术/" class="nav-link">
  会话技术
</a></li><li class="dropdown-item"><!----> <a href="/模板引擎/" class="nav-link">
  模板引擎
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/jiyaning" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="HTML" class="dropdown-title"><span class="title">HTML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/html/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/html/html5/" class="nav-link">
  HTML5
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/css/css3/" class="nav-link">
  CSS3
</a></li></ul></div></div><div class="nav-item"><a href="/Flex/" class="nav-link">
  Flex
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JS" class="dropdown-title"><span class="title">JS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/js基础/" class="nav-link">
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/js/js高级/" class="nav-link">
  JS高级
</a></li><li class="dropdown-item"><!----> <a href="/js/ES6/" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/js/正则表达式/" class="nav-link">
  正则
</a></li></ul></div></div><div class="nav-item"><a href="/jquery/" class="nav-link">
  Jquery
</a></div><div class="nav-item"><a href="/Web API/" class="nav-link">
  Web API
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Ajax" class="dropdown-title"><span class="title">Ajax</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/ajax/" class="nav-link">
  Ajax
</a></li><li class="dropdown-item"><!----> <a href="/ajax/axios/" class="nav-link">
  Axios
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue基础/" class="nav-link">
  vue基础
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue核心/" class="nav-link">
  vue核心
</a></li><li class="dropdown-item"><!----> <a href="/vue/vuex/" class="nav-link">
  vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react基础/" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/react/react核心/" class="nav-link">
  react核心
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><span class="title">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/node/" class="nav-link router-link-exact-active router-link-active">
  node
</a></li><li class="dropdown-item"><!----> <a href="/node/Express/" class="nav-link">
  Express
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/ .html" class="nav-link">
  mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/HTTP/" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/websocket/" class="nav-link">
  webSocket
</a></li><li class="dropdown-item"><!----> <a href="/会话技术/" class="nav-link">
  会话技术
</a></li><li class="dropdown-item"><!----> <a href="/模板引擎/" class="nav-link">
  模板引擎
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/jiyaning" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/node/node/#_1-node-js介绍" class="sidebar-link">1. node.js介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_1-1-node-js是什么" class="sidebar-link">1.1. node.js是什么</a></li><li class="sidebar-sub-header"><a href="/node/node/#_1-2-node-js和浏览器的关系" class="sidebar-link">1.2. node.js和浏览器的关系</a></li><li class="sidebar-sub-header"><a href="/node/node/#_1-3-node-js和javascript的区别" class="sidebar-link">1.3. node.js和javascript的区别</a></li><li class="sidebar-sub-header"><a href="/node/node/#_1-4-学习node-js" class="sidebar-link">1.4. 学习Node.js</a></li></ul></li><li><a href="/node/node/#_2-安装并使用nodejs" class="sidebar-link">2. 安装并使用nodejs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_2-1-下载" class="sidebar-link">2.1. 下载</a></li><li class="sidebar-sub-header"><a href="/node/node/#_2-2-安装" class="sidebar-link">2.2. 安装</a></li><li class="sidebar-sub-header"><a href="/node/node/#_2-3-测试是否安装成功" class="sidebar-link">2.3. 测试是否安装成功</a></li><li class="sidebar-sub-header"><a href="/node/node/#_2-4-在node环境下运行js代码" class="sidebar-link">2.4. 在node环境下运行js代码</a></li><li class="sidebar-sub-header"><a href="/node/node/#_2-5-nodejs的helloworld程序" class="sidebar-link">2.5.nodejs的helloworld程序</a></li></ul></li><li><a href="/node/node/#_3-nodejs中的模块化" class="sidebar-link">3. nodejs中的模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_3-1-模块化" class="sidebar-link">3.1. 模块化</a></li><li class="sidebar-sub-header"><a href="/node/node/#_3-2-node-js中的模块" class="sidebar-link">3.2. node.js中的模块</a></li><li class="sidebar-sub-header"><a href="/node/node/#_3-3-核心模块" class="sidebar-link">3.3. 核心模块</a></li></ul></li><li><a href="/node/node/#_4-fs模块" class="sidebar-link">4. fs模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_4-1-文件内容读取-readfile" class="sidebar-link">4.1. 文件内容读取 - readFile</a></li><li class="sidebar-sub-header"><a href="/node/node/#_4-2-文件写入" class="sidebar-link">4.2. 文件写入</a></li><li class="sidebar-sub-header"><a href="/node/node/#_4-3-fs模块中的常用方法" class="sidebar-link">4.3. fs模块中的常用方法</a></li></ul></li><li><a href="/node/node/#_5-路径问题" class="sidebar-link">5. 路径问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_5-1-获取绝对路径" class="sidebar-link">5.1. 获取绝对路径</a></li></ul></li><li><a href="/node/node/#_6-path模块" class="sidebar-link">6. path模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_6-1-path模块其它方法列表" class="sidebar-link">6.1. path模块其它方法列表</a></li></ul></li><li><a href="/node/node/#_7-http模块-基本使用" class="sidebar-link">7. http模块-基本使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_7-1-快速搭建web服务器" class="sidebar-link">7.1. 快速搭建Web服务器</a></li><li class="sidebar-sub-header"><a href="/node/node/#_7-2-理解请求与响应" class="sidebar-link">7.2. 理解请求与响应</a></li><li class="sidebar-sub-header"><a href="/node/node/#_7-3-根据不同-url-地址处理不同请求" class="sidebar-link">7.3. 根据不同 url 地址处理不同请求</a></li><li class="sidebar-sub-header"><a href="/node/node/#_7-4-使用-nodemon来自动重启http服务" class="sidebar-link">7.4. 使用 nodemon来自动重启http服务</a></li></ul></li><li><a href="/node/node/#_8-http模块-处理静态资源" class="sidebar-link">8. http模块-处理静态资源</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_8-1-处理二次请求" class="sidebar-link">8.1. 处理二次请求</a></li><li class="sidebar-sub-header"><a href="/node/node/#_8-2-为不同的文件类型设置不同的-content-type" class="sidebar-link">8.2. 为不同的文件类型设置不同的 Content-Type</a></li><li class="sidebar-sub-header"><a href="/node/node/#_8-3-批量处理请求" class="sidebar-link">8.3. 批量处理请求</a></li><li class="sidebar-sub-header"><a href="/node/node/#_8-4-接口与静态资源的区别" class="sidebar-link">8.4. 接口与静态资源的区别</a></li></ul></li><li><a href="/node/node/#_9-http模块-实现接口功能" class="sidebar-link">9. http模块-实现接口功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_9-1-get接口" class="sidebar-link">9.1. get接口</a></li><li class="sidebar-sub-header"><a href="/node/node/#_9-2-url模块" class="sidebar-link">9.2. url模块</a></li><li class="sidebar-sub-header"><a href="/node/node/#_9-3-querystring模块" class="sidebar-link">9.3. querystring模块</a></li><li class="sidebar-sub-header"><a href="/node/node/#_9-4-post接口" class="sidebar-link">9.4. post接口</a></li></ul></li><li><a href="/node/node/#_10-自定义模块" class="sidebar-link">10. 自定义模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_10-1-基本使用" class="sidebar-link">10.1. 基本使用</a></li><li class="sidebar-sub-header"><a href="/node/node/#_10-2-导出模块的两种方式" class="sidebar-link">10.2. 导出模块的两种方式</a></li></ul></li><li><a href="/node/node/#_11-npm使用" class="sidebar-link">11. npm使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_11-1-包（package）与模块关系" class="sidebar-link">11.1. 包（package）与模块关系</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-2-通过npm命令行下载第三方模块（包）" class="sidebar-link">11.2. 通过npm命令行下载第三方模块（包）</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-3-npm-init-命令" class="sidebar-link">11.3. npm init 命令</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-4-node-modules文件夹" class="sidebar-link">11.4. node_modules文件夹</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-5-全局安装包和本地安装包" class="sidebar-link">11.5 全局安装包和本地安装包</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-6-全局安装nrm包" class="sidebar-link">11.6. 全局安装nrm包</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-7-require的加载机制" class="sidebar-link">11.7. require的加载机制</a></li><li class="sidebar-sub-header"><a href="/node/node/#_11-8-npm-常用命令" class="sidebar-link">11.8. npm 常用命令</a></li></ul></li><li><a href="/node/node/#_12-跨域" class="sidebar-link">12. 跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/node/#_12-1-问题演示" class="sidebar-link">12.1. 问题演示</a></li><li class="sidebar-sub-header"><a href="/node/node/#_12-2-实现跨域请求的方案-cors" class="sidebar-link">12.2. 实现跨域请求的方案--CORS</a></li><li class="sidebar-sub-header"><a href="/node/node/#_12-3-jsonp-vs-cors-对比" class="sidebar-link">12.3. jsonp vs cors 对比</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node"><a href="#node" class="header-anchor">#</a> node</h1> <h2 id="_1-node-js介绍"><a href="#_1-node-js介绍" class="header-anchor">#</a> 1. node.js介绍</h2> <h3 id="_1-1-node-js是什么"><a href="#_1-1-node-js是什么" class="header-anchor">#</a> 1.1. node.js是什么</h3> <ul><li>Node.js® is a JavaScript runtime built on <a href="https://v8.dev/" target="_blank" rel="noopener noreferrer">Chrome's V8 JavaScript engine<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>Node.js® 是一个基于 <a href="https://v8.dev/" target="_blank" rel="noopener noreferrer">Chrome V8 引擎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 JavaScript 运行时（运行环境）</li></ul> <ul><li>Node全名是Node.js，但它不是一个js文件，而是一个软件</li> <li>Node.js是一个<strong>基于Chrome V8引擎</strong>的<strong>ECMAScript的运行环境</strong>，在这个环境中可以执行js代码</li> <li>Node.js提供了大量的工具（API），能够完成文件读写、Web服务器创建等功能。</li></ul> <img src="https://jiyaning.github.io/staticImgs/images/node01.png"> <h3 id="_1-2-node-js和浏览器的关系"><a href="#_1-2-node-js和浏览器的关系" class="header-anchor">#</a> 1.2. node.js和浏览器的关系</h3> <p><code>相同之处</code>：</p> <ul><li>都可以运行js(严格来讲是ECMAScript)代码</li></ul> <p><code>不同之处</code>：</p> <table><thead><tr><th>浏览器中的JS</th> <th>Node中的JS</th></tr></thead> <tbody><tr><td>ECMAScript核心</td> <td>ECMAScript核心</td></tr> <tr><td>DOM</td> <td>全局成员</td></tr> <tr><td>BOM</td> <td>模块系统（系统模块，第三方模块，自定义模块）</td></tr></tbody></table> <ul><li>安装浏览器，可以执行<strong>ECMAScript</strong>，浏览器内置了window对象，所以浏览器有处理<strong>DOM和BOM</strong>的能力。</li> <li>安装了Node.Js，可以执行<strong>ECMAScript</strong>，NodeJS内置了一些功能，包括<strong>全局成员和模块系统</strong>，同时还可以载<strong>入第三方模块</strong>来完成更强大的功能。</li></ul> <h3 id="_1-3-node-js和javascript的区别"><a href="#_1-3-node-js和javascript的区别" class="header-anchor">#</a> 1.3. node.js和javascript的区别</h3> <ul><li>node.js是一个容器（不是一个新语言），ECAMScript程序可以在这个容器中运行。
<ul><li>不能在node.js使用window对象，也不能在node.js使用dom操作。因为node.js中并不包含这个对象。</li></ul></li> <li>javascript是由三个部分组成：ECMAScript,BOM,DOM</li></ul> <h3 id="_1-4-学习node-js"><a href="#_1-4-学习node-js" class="header-anchor">#</a> 1.4. 学习Node.js</h3> <p><code>意义:</code></p> <ul><li>使得JS能够和操作系统 “互动” （读取文件，写入文件等，管理进程）</li> <li>为JavaScript提供服务端编程的能力
<ul><li>文件IO</li> <li>网络IO</li> <li>数据库</li></ul></li> <li><strong>了解接口开发，进一步理解Web开发，了解后端工作内容</strong></li></ul> <p><code>学习内容:</code></p> <ul><li>模块系统</li></ul> <h2 id="_2-安装并使用nodejs"><a href="#_2-安装并使用nodejs" class="header-anchor">#</a> 2. 安装并使用nodejs</h2> <h3 id="_2-1-下载"><a href="#_2-1-下载" class="header-anchor">#</a> 2.1. 下载</h3> <p>官网： https://Nodejs.org/en/</p> <p>中文网：http://Nodejs.cn/</p> <p><code>版本说明:</code></p> <ul><li><strong>LTS</strong>： 长期稳定版(Long Term Support))。 项目开发建议使用长期稳定版</li> <li><strong>Current</strong>： 最新版。最新版包含了一些新功能，如果想学习最新的功能，则可以使用该版本。最新版可能会有一些未知的bug。</li></ul> <h3 id="_2-2-安装"><a href="#_2-2-安装" class="header-anchor">#</a> 2.2. 安装</h3> <ol><li><p>双击安装文件开始安装（不同系统选择对应的安装文件）</p></li> <li><p>傻瓜式安装，一路 'next' 即可</p></li></ol> <p><code>注意</code>：</p> <ul><li>建议安装目录使用<strong>英文路径</strong></li></ul> <h3 id="_2-3-测试是否安装成功"><a href="#_2-3-测试是否安装成功" class="header-anchor">#</a> 2.3. 测试是否安装成功</h3> <p>打开任意一个<strong>小黑窗</strong>，输入<code>node -v</code>能够看到Node.js版本号即为安装成功。</p> <ul><li><p>cmd窗口(window+R, ---&gt;运行--&gt;录入cmd,回车)</p></li> <li><p>powershell（window10操作系统）</p></li></ul> <h3 id="_2-4-在node环境下运行js代码"><a href="#_2-4-在node环境下运行js代码" class="header-anchor">#</a> 2.4. 在node环境下运行js代码</h3> <p>有两种方式可以运行js代码：</p> <ul><li>在nodejs 提供的repl环境中</li> <li>单独执行外部的js文件</li></ul> <blockquote><p>方法1：在 REPL中运行</p></blockquote> <p>REPL(Read Eval Print Loop:交互式解释器) 表示一个电脑的环境，类似 Window 系统的终端或 Unix/Linux shell，可以在终端中输入命令，并接收系统的响应。</p> <p>Node 自带了交互式解释器，可以执行以下任务：</p> <ul><li><strong>读取</strong> - 读取用户输入，解析输入了Javascript 数据结构并存储在内存中。</li> <li><strong>执行</strong> - 执行输入的数据结构</li> <li><strong>打印</strong> - 输出结果</li> <li><strong>循环</strong> - 循环操作以上步骤直到用户两次按下 <strong>ctrl-c</strong> 按钮退出。</li></ul> <p>具体操作：</p> <ol><li>在任意控制台中输入node 并回车确定，即可进行入node自带的REPL环境。</li> <li>此时，可以正常写入js代码，并执行。</li> <li>如果要退出，<strong>连续按下两次ctrl+c</strong></li></ol> <blockquote><p>方法2：执行一个JS文件</p></blockquote> <ol><li>事先准备好一个js文件。
<ul><li>路径是：e:/index.js</li> <li>具体内容是</li></ul></li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>打开小黑窗，进入到这个文件的目录
<ul><li>技巧，在资源管理器中按下shift，同时点击鼠标右键，可以选择在此处打开powershell窗口。</li> <li>cd 命令可以用来切换当前目录。</li></ul></li> <li>接下来 通过  <code>node js文件的路径</code>   的格式来执行这个js文件。</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>node index<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意:</p> <ul><li>执行js文件时，如果当前命令行目录和js文件<strong>不在</strong>同一个盘符下，要先<strong>切换盘符</strong> <ul><li>切换方式，输入<code>盘符:</code>并回车</li></ul></li> <li>如果当前命令行目录和js文件<strong>在</strong>同一个盘符中，则可以使用<strong>相对路径</strong>找到js文件并执行</li></ul> <h3 id="_2-5-nodejs的helloworld程序"><a href="#_2-5-nodejs的helloworld程序" class="header-anchor">#</a> 2.5.nodejs的helloworld程序</h3> <p>下面是一个最基本的http服务器程序：</p> <ul><li><p>第一步：新建一个文件，名为  <code>d:/http.js</code>( 文件名及路径名可以自行设置，建议均不使用中文字符)</p></li> <li><p>第二步：在文件中录入如下代码。</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 引入http模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建服务</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">来自</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>remoteAddress<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的客户端在</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleTimeString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">访问了本服务器</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;hello world! very good!!&lt;/h1&gt; &lt;p&gt;'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>remoteAddress <span class="token operator">+</span> <span class="token string">'&lt;/p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启动服务</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器启动成功，请在http://localhost:8081中访问....'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><p>第三步：在小黑窗中进入到d盘根目录，键入命令 <code>node http.js</code></p></li> <li><p>第四步：打开一个浏览器，输入'http://localhost:8081'，观察效果</p></li> <li><p>第五步：把localhost改成自己电脑的ip地址，再把这个路径发给其他人来访问。</p></li></ul> <ul><li>如果不能访问，有可能需要手动关闭自己计算机的防火墙。</li></ul> <h2 id="_3-nodejs中的模块化"><a href="#_3-nodejs中的模块化" class="header-anchor">#</a> 3. nodejs中的模块化</h2> <ul><li>在项目的开发过程中，随着功能的不断增强，代码量，文件数量也急剧增加，需要把一个大函数拆成小函数，把一个大文件拆成小文件，把一个大功能拆成若干个小功能。这里很自然地就涉及到模块化的想法：一个复杂的系统分成几个子系统，体现在几个小的文件在一起组成一个大的文件，集成强大的功能。</li> <li>es5不支持模块化：就是在一个js文件内不能引入其他js文件。不能通过一个大文件去集成若干个小文件。
<ul><li>会带来多个问题：
<ol><li>文件的加载先后顺序</li> <li>不同的文件内部定义的变量共享</li></ol></li></ul></li></ul> <h3 id="_3-1-模块化"><a href="#_3-1-模块化" class="header-anchor">#</a> 3.1. 模块化</h3> <ul><li>一个js文件中可以引入其他的js文件，能使用引入的js文件的中的变量、数据，这种特性就称为模块化。
<ul><li>使用模块化开发可以很好的解决变量、函数名冲突问题，也能灵活的解决文件依赖问题。</li></ul></li></ul> <ul><li><p>以前</p> <p>es5不支持模块化，让前端人员很为难。为了让支持模块化，一般会借用第三方库来实现：</p> <ul><li>sea.js. https://www.zhangxinxu.com/sp/seajs/</li> <li>require.js. https://requirejs.org/</li></ul></li> <li><p>现在</p> <ul><li>es6原生语法支持模块化</li> <li>Node.js内部支持模块化（与es6的模块化有些不同之处）</li></ul></li></ul> <h3 id="_3-2-node-js中的模块"><a href="#_3-2-node-js中的模块" class="header-anchor">#</a> 3.2. node.js中的模块</h3> <p><strong>每个模块都是一个独立的文件。每个模块都可以完成特定的功能</strong>，需要时就去引入它们，并调用。不需要时也不需要去管它。（理解于浏览器的js中的Math对象）</p> <p><code>nodejs模块的分类:</code></p> <ul><li><strong>核心模块</strong> (类似内置对象Array Math Date...)
<ul><li>nodejs<strong>自带的模块</strong>，在安装完nodejs之后，就可以随意使用啦。相当于学习js时使用的内置对象。</li> <li>全部模块的源代码 https://github.com/nodejs/node/tree/master/lib</li></ul></li> <li><strong>自定义模块</strong> (类似config.js user.js  common.js)
<ul><li>程序员自己写的模块。就相当于学习js时的自定义函数。</li></ul></li> <li><strong>第三方模块</strong> (jQuery template-web.js )
<ul><li>其他程序员写好的模块。nodejs生态提供了一个专门的工具来管理第三方模块。</li> <li>相当于别人写好的函数或者库。例如jQuery库，artTemplate等。</li></ul></li></ul> <h3 id="_3-3-核心模块"><a href="#_3-3-核心模块" class="header-anchor">#</a> 3.3. 核心模块</h3> <blockquote><p>官网文档 https://nodejs.org/dist/latest-v10.x/docs/api/</p> <p>中文文档 http://nodejs.cn/api/</p></blockquote> <ul><li>核心模块就是 Node 内置的模块，需要通过唯一的标识名称来进行获取。</li> <li>每一个核心模块基本上都是暴露了一个对象，里面包含一些方法供使用</li> <li>一般在加载核心模块的时候，变量的命名最好就和核心模块的标识名同名即可
<ul><li>例如：<code>const fs = require('fs')</code></li></ul></li></ul> <p><code>示例：</code></p> <p>用<strong>fs模块</strong>读取文件</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> htmlStr <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>htmlStr<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>注意：<strong>require()中直接写模块的名字</strong></p> <ul><li>不要加.js</li> <li>不要加其它路径</li></ul> <h2 id="_4-fs模块"><a href="#_4-fs模块" class="header-anchor">#</a> 4. fs模块</h2> <p>fs模块是<strong>文件操作模块</strong>。fs是 FileSystem的简写。它用来对文件，文件夹进行操作。</p> <p>手册：http://nodejs.cn/api/fs.html</p> <h3 id="_4-1-文件内容读取-readfile"><a href="#_4-1-文件内容读取-readfile" class="header-anchor">#</a> 4.1. 文件内容读取 - readFile</h3> <p>fs模块中操作文件(或者文件夹)的方法，大多都提供了两种选择：</p> <ul><li>异步版本的       readFile</li> <li>同步版本的       readFileSync</li></ul> <blockquote><p>异步格式</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入模块。可以使用var、let，但是建议使用const，因为不希望它被改变</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'文件路径'</span><span class="token punctuation">[</span><span class="token punctuation">,</span>选项<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>说明</code>：</p> <ul><li><p>第一个参数：文件路径。 相对路径和绝对路径均可。</p></li> <li><p>第二个参数： 配置项，可选参数。主要用来配置字符集。一般可设置为'utf8'</p> <ul><li>如果不设置该参数，文件内容会以二进制形式buffer返回。</li> <li>可以使用 toString() 方法将二进制数据转为正常字符串</li></ul></li> <li><p>参数3: 读取完成后触发的回调函数。有两个参数 --- err 和 data</p> <ul><li><p>读取成功</p> <ul><li><p>err: null</p></li> <li><p>data: 文件内容</p></li></ul></li> <li><p>读取失败</p> <ul><li>err: 错误对象</li></ul></li> <li><p>data: undefined</p></li></ul></li></ul> <p><code>示例</code>：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'文件路径'</span><span class="token punctuation">,</span><span class="token string">&quot;utf8&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>同步格式</p></blockquote> <p>与异步格式不同在于：</p> <ul><li>api的名字后面有Sync</li> <li>不是通过回调函数来获取值，而是像一个普通的函数调用一样，直接获取返回值</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里放置可能会出现报错的代码</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'demo12.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果try块中出现报错，错误不会真的报出来，而是执行catch中的补救代码</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件读取有误，请检查文件地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// err是错误的详细信息，如果不想使用，可以去除catch后面的(err)部分</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>异常捕获:</code></p> <ul><li>程序执行时，如果出现报错，会导致程序执行终止</li> <li>通过try{}  catch{}进行异常捕获</li> <li>异常捕获：当不希望代码出现报错时的一种补救手段</li></ul> <h3 id="_4-2-文件写入"><a href="#_4-2-文件写入" class="header-anchor">#</a> 4.2. 文件写入</h3> <blockquote><p>覆盖写入 writeFile</p></blockquote> <ul><li><p>功能：向指定文件中写入字符串（覆盖写入）， 如果没有该文件则尝试创建该文件。它把文件中的内容全部删除，再填入新的内容。</p></li> <li><p>格式：<code>fs.writeFile(var1, var2, var3, var4);</code></p> <ul><li>参数1: 要写入的文件路径 --- 相对路径和绝对路径均可，推荐使用绝对路径</li> <li>参数2: 要写入文件的字符串</li> <li>参数3: 配置项，设置写入的字符集，默认utf-8</li> <li>参数4: 写入完成后触发的回调函数，有一个参数 --- err （错误对象）</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./a.txt'</span><span class="token punctuation">,</span> <span class="token string">'hello world niahi \n asfsdf'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> err
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>文件追加 appendFile</p></blockquote> <ul><li><p>功能 ：向指定文件中写入字符串（追加写入）， 如果没有该文件则尝试创建该文件</p></li> <li><p>格式：<code>fs.appendFile(var1, var2, var3, var4);</code></p> <ul><li>参数1: 要写入的文件路径 --- 相对路径和绝对路径均可，推荐使用绝对路径</li> <li>参数2: 要写入文件的字符串</li> <li>参数3: 配置项，设置写入的字符集，默认utf-8</li> <li>参数4: 写入完成后触发的回调函数，有一个参数 --- err （错误对象）</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./a.txt'</span><span class="token punctuation">,</span> <span class="token string">'\n 为天地立命'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">throw</span> err
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-3-fs模块中的常用方法"><a href="#_4-3-fs模块中的常用方法" class="header-anchor">#</a> 4.3. fs模块中的常用方法</h3> <table><thead><tr><th>API</th> <th>作用</th> <th>备注</th></tr></thead> <tbody><tr><td>fs.access(path, callback)</td> <td>判断路径是否存在</td> <td></td></tr> <tr><td>fs.appendFile(file, data, callback)</td> <td>向文件中追加内容</td> <td></td></tr> <tr><td>fs.copyFile(src, callback)</td> <td>复制文件</td> <td></td></tr> <tr><td>fs.mkdir(path, callback)</td> <td>创建目录</td> <td></td></tr> <tr><td>fs.readDir(path, callback)</td> <td>读取目录列表</td> <td></td></tr> <tr><td>fs.rename(oldPath, newPath, callback)</td> <td>重命名文件/目录</td> <td></td></tr> <tr><td>fs.rmdir(path, callback)</td> <td>删除目录</td> <td>只能删除空目录</td></tr> <tr><td>fs.stat(path, callback)</td> <td>获取文件/目录信息</td> <td></td></tr> <tr><td>fs.unlink(path, callback)</td> <td>删除文件</td> <td></td></tr> <tr><td>fs.watch(filename[, options][, listener])</td> <td>监视文件/目录</td> <td></td></tr> <tr><td>fs.watchFile(filename[, options], listener)</td> <td>监视文件</td> <td></td></tr> <tr><td>fs.existsSync(absolutePath)</td> <td>判断路径是否存在</td> <td></td></tr></tbody></table> <h2 id="_5-路径问题"><a href="#_5-路径问题" class="header-anchor">#</a> 5. 路径问题</h2> <p>在读取文件时，写相对路径是容易出问题的。假设有如下两个文件，它们所处的目录及文件名如下所示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>day01<span class="token operator">/</span>js<span class="token operator">/</span>fs<span class="token punctuation">.</span>js
day01<span class="token operator">/</span>js<span class="token operator">/</span>text<span class="token punctuation">.</span>txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>fs.js代码的作用是读出text.txt中的内容，并显示出来。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">readfilesync</span><span class="token punctuation">(</span><span class="token string">&quot;./text.txt&quot;</span><span class="token punctuation">,</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//注意这里对text.txt的访问使用的是相对&quot;fs.js&quot; 本身的路径</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>现在运行fs.js这个文件有两种方式：</p> <ul><li>如果终端中的路径定位在<code>js目录</code>下，则通过<code>node fs.js</code></li> <li>如果终端中的路径定位在<code>day01目录</code>下，则通过：<code>node js/fs.js</code> 此时就不能正确找到文件了。</li></ul> <p>原因是：我们在fs中读取文件时，使用的是相对路径，而<strong>相对路径的参考点是运行这个js文件的小黑窗的路径</strong>。</p> <p><strong>相对路径相对的是终端/cmd/ps的路径位置</strong>     而这个路径我们是可以通过cd命名来调整的。</p> <p>解决方法，就是在操作文件时，使用<strong>绝对路径</strong>来定位文件。</p> <h3 id="_5-1-获取绝对路径"><a href="#_5-1-获取绝对路径" class="header-anchor">#</a> 5.1. 获取绝对路径</h3> <p>绝对路径： 从磁盘根目录开始到指定文件的路径。</p> <p>相对路径：是以某个文件的位置为起点，相对于这个位置来找另一个文件。</p> <p>nodejs中提供了两个全局变量来获取绝对路径：</p> <blockquote><p>__dirname：获取当前被执行的文件的文件夹所处的绝对路径</p></blockquote> <blockquote><p>__filename：获取当前被执行的文件的绝对路径</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 文件所处目录的绝对路径（不含文件名）</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 文件的绝对路径（含文件名）</span>

<span class="token comment">// 使用__dirname进行文件的读取操作</span>
<span class="token comment">// 1 引入fs模块</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2 读取文件</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/demo1.js'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_6-path模块"><a href="#_6-path模块" class="header-anchor">#</a> 6. path模块</h2> <p>http://nodejs.cn/api/path.html#path_path</p> <p>path模块是node中的一个核心模块，专门用来进行路径处理，用来处理路径问题：拼接，分析，取后缀名。</p> <ul><li>path.basename（路径）      获取文件名</li> <li><strong>path.join()</strong>  （常用）   拼接路径</li> <li>path.parse(path)       转成一个对象</li> <li>path.extname()         以从一段地址内容中获取到扩展名(后缀)</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/foo/bar/baz/asdf/quux.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 返回: 'quux.html'</span>
path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/foo/bar/baz/asdf/quux.html'</span><span class="token punctuation">,</span> <span class="token string">'.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 返回: 'quux'</span>
path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token string">'/foo/bar/baz/asdf/quux'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// 返回: '/foo/bar/baz/asdf'</span>
path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token comment">// 返回: '.html'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1 引入path模块和fs模块</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 通过path模块的方法对绝对路径进行处理</span>
<span class="token comment">// path.join() 可以将各种各样的地址合并为一个地址</span>
<span class="token comment">// console.log(path.join(__dirname, '/demo1.js'));   // join处理后结果相同</span>
<span class="token comment">// console.log(path.join(__dirname, './demo1.js'));  // join处理后结果相同</span>
<span class="token comment">// console.log(path.join(__dirname, 'demo1.js'));    // join处理后结果相同</span>

<span class="token comment">// console.log(path.join(__dirname, '../1.js'));</span>
<span class="token comment">// console.log(path.join(__dirname, '../demo/test/', './1.html')); // 此为演示，没有这些路径</span>

<span class="token comment">// 以后进行路径处理，将path.join(__dirname, '相对路径') 做为固定格式，后面的相对路径根据需求修改即可</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../1.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_6-1-path模块其它方法列表"><a href="#_6-1-path模块其它方法列表" class="header-anchor">#</a> 6.1. path模块其它方法列表</h3> <table><thead><tr><th>方法</th> <th>作用</th></tr></thead> <tbody><tr><td>path.basename(path[, ext])</td> <td>获取返回 path 的最后一部分(文件名)</td></tr> <tr><td>path.dirname(path)</td> <td>返回目录名</td></tr> <tr><td>path.extname(path)</td> <td>返回路径中文件的扩展名(包含.)</td></tr> <tr><td>path.format(pathObject)</td> <td>将一个对象格式化为一个路径字符串</td></tr> <tr><td>path.join([...paths])</td> <td>拼接路径</td></tr> <tr><td>path.parse(path)</td> <td>把路径字符串解析成对象的格式</td></tr> <tr><td>path.resolve([...paths])</td> <td>基于当前工作目录拼接路径</td></tr></tbody></table> <h2 id="_7-http模块-基本使用"><a href="#_7-http模块-基本使用" class="header-anchor">#</a> 7. http模块-基本使用</h2> <p>http是nodejs的核心模块，能够通过简单的代码创建一个Web服务器，处理http请求。</p> <h3 id="_7-1-快速搭建web服务器"><a href="#_7-1-快速搭建web服务器" class="header-anchor">#</a> 7.1. 快速搭建Web服务器</h3> <p><code>过程:</code></p> <ol><li>新建文件，写入如下代码：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// http.js</span>
<span class="token comment">// 引入核心模块http</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建服务</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>remoteAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启动服务</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="2"><li>运行代码, <code>node http.js</code></li> <li>在浏览器地址栏中输入：localhost:8081 观察效果。</li></ol> <p><code>说明:</code></p> <ol><li><p>把localhost改成本机ip地址，可以让同一局域网的其他人访问。</p></li> <li><p>如果修改了代码，必须先停止服务，然后再启动。这样才能生效。ctrl+c 停止服务。</p></li> <li><p>更改res.end()的内容，<code>重启</code>后，再次观察。</p> <ul><li>获取ip，返回给浏览器</li></ul></li></ol> <h3 id="_7-2-理解请求与响应"><a href="#_7-2-理解请求与响应" class="header-anchor">#</a> 7.2. 理解请求与响应</h3> <p>在上面的代码中，通过http.createServer方法创建一个http服务。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建服务</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>remoteAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>http.createServer（）方法的参数是一个匿名函数，充当回调函数，当有http请求时，它会自动被调用。</p> <p>这个回调函数有两个参数。这两个参数非常重要，也非常复杂.</p> <blockquote><p>参数1：表示来自客户端浏览器的请求，形参名并不重要，一般使用req或者request表示</p></blockquote> <blockquote><p>参数2：用来设置对本次请求的响应，形参名并不重要，一般使用res或者resposne表示</p></blockquote> <ul><li><p>当某个客户端来请求这个服务器时，这个函数会自动调用，同时会自动给这两个参数赋值。</p></li> <li><p>第一个参数中包括本次请求的信息。</p> <ul><li>req：请求
<ul><li><strong>req.url</strong>                本次请求的地址</li> <li><strong>req.method</strong>      获取请求行中的请求方法</li> <li><strong>req.headers</strong>      获取请求头</li></ul></li></ul></li> <li><p>第二个参数用来设置本服务器对这次请求的处理。</p> <ul><li><p>这个参数一般命名是res，它是一个对象，其中有很多方法和属性。</p></li> <li><p><strong>res.end()</strong></p> <ul><li>把本次的处理结果返回给客户端浏览器</li> <li>如果不写这一句，则客户端浏览器永远收不到响应。</li></ul></li> <li><p><strong>res.setHeader()</strong>  设置响应头，比如设置响应体的编码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">,</span> <span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>res.statusCode</strong> 设置状态码</p></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1 引入http模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 调用createServer()创建服务</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// req.url 代表用户的请求地址</span>
    <span class="token comment">// 我们可以通过判断req.url进行不同的响应处理</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// req.method 代表用户的请求方式</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// req.headers 代表用户的请求头信息</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 提前设置一个响应内容</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听8000成功...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-3-根据不同-url-地址处理不同请求"><a href="#_7-3-根据不同-url-地址处理不同请求" class="header-anchor">#</a> 7.3. 根据不同 url 地址处理不同请求</h3> <p>根据url地址的不同，做出合适的响应,首先就需要知道浏览器请求的url是什么。</p> <p>涉及到和请求相关的信息，都是通过请求响应处理函数的第一个参数完成的。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// http.js</span>
<span class="token comment">// 引入核心模块http</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建服务</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">&quot;/a.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 读出文件内容</span>
        <span class="token comment">// 通过res.end()返回</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">&quot;/b.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启动服务</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-4-使用-nodemon来自动重启http服务"><a href="#_7-4-使用-nodemon来自动重启http服务" class="header-anchor">#</a> 7.4. 使用 nodemon来自动重启http服务</h3> <p>每次修改了代码，都需要重启http服务器:</p> <ol><li>进入控制台</li> <li>按下ctrl+c，停止已有http服务器。</li> <li>手动运行：node index.js 来重启服务器。</li></ol> <ul><li><p>nodemon工具会自动检测到修改并自动重新运行代码</p></li> <li><p>nodemon。https://www.npmjs.com/package/nodemon</p></li></ul> <p><code>安装 nodemon:</code></p> <p>通过npm包管理工具来进行安装。任意打开一个小黑窗，输入如下命令</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g nodemon
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>说明：它是一个第三方的包（其它开发者写的工具），这里是通过全局安装的方式进行。</p> <blockquote><p>npm是一个工具。用来管理node代码中要使用的第三方模块。它是随着node的安装而自动安装的,</p> <p>如果安装了node，则npm也已经安装过了，可以直接使用。</p></blockquote> <p><code>使用nodemon:</code></p> <p>等待安装成功之后，使用方法也非常简单：在命令中，使用nodemon来代替node。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>node server<span class="token punctuation">.</span>js  
<span class="token comment">// 改成 nodemon server.js</span>
nodemon server<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>nodemon的好处在于会自动监听server.js这个文件的变化，如果变化了，就会重新自动再去运行。</p> <h2 id="_8-http模块-处理静态资源"><a href="#_8-http模块-处理静态资源" class="header-anchor">#</a> 8. http模块-处理静态资源</h2> <p>静态资源指的是html文件中链接的外部资源，如css、js、image文件等等。</p> <h3 id="_8-1-处理二次请求"><a href="#_8-1-处理二次请求" class="header-anchor">#</a> 8.1. 处理二次请求</h3> <ul><li><p>从服务器获取html文件之后，如果这个html文件中还引用了其它的外部资源（图片，样式文件等），则浏览器会重新再发请求。</p></li> <li><p>假设在index.html中还引入了 style.css 1.png 或者 .js文件，则：</p> <ul><li>浏览器请求localhost:index.html之后，得到的从服务器反馈的内容，解析的过程中还发现有外部的资源，所以浏览器会再次发出第二次请求，再去请求相应的资源。</li></ul></li> <li><p>一个最朴素的想法是根据不同的请求来返回不同的文件。</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建一个web服务器，能够进行静态资源展示(html css js jpg的访问)</span>
<span class="token comment">// 1 引入http、fs、path模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 创建一个web服务器</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 3.1 进行首页的请求处理</span>
    <span class="token comment">// 首页的请求地址通常为 '/'  '/index.html'</span>
    <span class="token comment">// 检测req.url的取值即可</span>
    <span class="token keyword">var</span> reqUrl <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl <span class="token operator">===</span> <span class="token string">'/'</span> <span class="token operator">||</span> reqUrl <span class="token operator">===</span> <span class="token string">'/index.html'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 3.2 读取首页index.html的文件响应给客户端</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./index3.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.3 使用res.end()进行响应即可</span>
        <span class="token comment">// 3.4 推荐在响应之前进行响应头设置，用来准确告诉客户端响应的数据是什么形式</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4 进行css文件的响应</span>
        <span class="token comment">//  先查看浏览器中css文件请求的地址，进行url检测</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl <span class="token operator">===</span> <span class="token string">'/css/base.css'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./css/base.css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/css;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5 进行js文件的响应</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl <span class="token operator">===</span> <span class="token string">'/js/tool.js'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./js/tool.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/javascript;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 6 进行图片文件的响应</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl <span class="token operator">===</span> <span class="token string">'/img/1.jpg'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./img/1.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'image/jpeg;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 纯文本类型设置</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'不好意思，不知道你请求的是什么文件'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听8000成功...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h3 id="_8-2-为不同的文件类型设置不同的-content-type"><a href="#_8-2-为不同的文件类型设置不同的-content-type" class="header-anchor">#</a> 8.2. 为不同的文件类型设置不同的 Content-Type</h3> <ul><li>通过使用res对象中的setHeader()方法，可以设置content-type这个响应头。</li> <li>响应头的作用是告诉浏览器，本次响应的内容是什么格式的内容。以方便浏览器进行处理。</li></ul> <p>常见的几种文件类型及content-type如下:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">.</span>html：    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span>css：     res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'text/css;charset=utf-8'</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span>js：      res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/javascript;charset=utf-8'</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span>png：     res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">,</span> <span class="token string">'image/jpeg;charset=utf-8'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>其它类型，参考这里：https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types</p> <blockquote><p>进行不同格式的文件响应时，推荐设置响应体的内容类型</p> <p>不同格式的类型名称不同，这种类型名称称为 MIME-Type</p> <p>不需要记忆，使用时可以到文档中查看</p> <p>https://www.w3school.com.cn/media/media_mimeref.asp</p></blockquote> <h3 id="_8-3-批量处理请求"><a href="#_8-3-批量处理请求" class="header-anchor">#</a> 8.3. 批量处理请求</h3> <p>由于无法事先得知一个.html文件中会引用多少个静态资源，所以，不能像处理某个页面一样去处理它们。</p> <p><code>解决办法有两种：</code></p> <ul><li>把这类静态资源连同所有的.html文件全放在固定的文件夹中。在用户请求时，判断当前的req.url是在这个文件夹下 ,就直接读内容，并返回。</li></ul> <ul><li>分析后缀名，如果是允许的，就直接返回</li></ul> <p><code>基本的静态资源处理：</code></p> <ul><li>实现方式就是判断每个文件请求时的url，并进行具体判断和处理即可</li> <li>问题是文件较多时，书写较为繁琐</li></ul> <p><code>静态资源托管:</code></p> <ul><li>可以通过某些操作进行统一处理</li> <li>实现步骤：</li> <li>首页地址判断（判断url是否为/或/index.html）(网站的约定规则)
<ul><li>其余静态资源托管的功能
<ul><li>将不同类型的文件保存在不同的文件夹中（例如js文件在js目录中，css文件在css目录中..）
<ul><li>进行统一的静态资源请求时，地址没有共性，就无法判断用户是不是请求了静态资源</li> <li>将所有的静态资源保存在一个统一的目录中 一般称为public</li></ul></li> <li>页面中的文件地址设置为 /public或者 http://localhost:8000/public的形式即可
<ul><li>具体写法见index.html中的说明</li></ul></li> <li>通过对请求url地址的后缀名进行检测，并从不同的目录中读取文件即可</li> <li>响应文件内容</li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1 引入相关模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 创建一个服务器实例</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 3 对请求进行处理</span>
  <span class="token keyword">const</span> reqUrl <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span>

  <span class="token comment">// 3.1 进行首页检测</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl <span class="token operator">===</span> <span class="token string">'/'</span> <span class="token operator">||</span> reqUrl <span class="token operator">===</span> <span class="token string">'/index.html'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tempPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./public/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>tempPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3.1.1 设置响应头</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3.1.2 设置响应体</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4 静态资源托管处理</span>
    <span class="token comment">//  4.1 检测是否为静态资源：都以/public/开头</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>reqUrl<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'/public/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 4.2 获取当前请求的静态资源的后缀，进行响应头的设置</span>
    <span class="token keyword">const</span> ext <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>reqUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> mimeType<span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'.css'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'text/css'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'.js'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'application/javascript'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'.jpg'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'image/jpeg'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'.bmp'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'image/bmp'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'.png'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'image/png'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'.gif'</span><span class="token operator">:</span>
        mimeType <span class="token operator">=</span> <span class="token string">'image/gif'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> mimeType <span class="token operator">+</span> <span class="token string">';charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4.3 根据url读取文件内容</span>
    <span class="token keyword">let</span> tempPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> reqUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>tempPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听8000端口成功...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h3 id="_8-4-接口与静态资源的区别"><a href="#_8-4-接口与静态资源的区别" class="header-anchor">#</a> 8.4. 接口与静态资源的区别</h3> <img src="https://jiyaning.github.io/staticImgs/images/接口与静态资源的区别.png"> <p>服务器上有很多资源，每个资源都有自己的url。客户端浏览器想要访问某个资源就要向服务器发起对应的请求。</p> <ul><li>资源的分类：</li></ul> <p><code>静态资源:</code></p> <ul><li>它们一般表现为一个一个的<strong>文件</strong>。例如index.html, style.css, index.js。</li> <li>处理请求静态资源时，服务器一般就直接读出资源的内容，再返回给客户端浏览器</li></ul> <p><code>动态资源：接口</code></p> <ul><li>它们不是以某个具体的文件存在的，而是<strong>通过服务器上的一段代码处理得到的数据</strong>，访问接口时，服务器会执行这段代码，然后把代码的执行结果返回给客户端浏览器。</li></ul> <h2 id="_9-http模块-实现接口功能"><a href="#_9-http模块-实现接口功能" class="header-anchor">#</a> 9. http模块-实现接口功能</h2> <h3 id="_9-1-get接口"><a href="#_9-1-get接口" class="header-anchor">#</a> 9.1. get接口</h3> <ul><li><p>get请求的参数附加在url中</p> <ul><li>使用url模块来取出用户url中的参数部分</li> <li>使用querystring模块取出具体的参数值</li></ul></li> <li><p>req.url：请求地址,除了含有接口地址，还含有请求参数</p> <ul><li><p>使用url.parse()将req.url处理为多部份的形式(对象结构)</p></li> <li><p>返回值是将地址处理得到的对象结构</p> <ul><li><p>pathname 路径名称，就是需要的接口名（不含参数）</p></li> <li><p>query 请求参数，不含?部分，是url编码格式</p> <ul><li><p>url.parse()传入参数2为true时，query的值为对象结构(常用方式)</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// - 声明变量保存我们需要使用的两个属性,解构赋值</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> pathname<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul></li></ul></li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入http模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入url模块</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 创建web服务器实例</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// - 声明变量保存我们需要使用的两个属性</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> pathname<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pathname <span class="token operator">===</span> <span class="token string">'/admin/getCate'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// - 根据需求进行响应处理即可</span>
        <span class="token comment">//   - 例如，设置模拟响应内容，根据用户的id筛选部分数据，再传递一个时间戳、status和msg即可</span>
        <span class="token comment">//   - 设置假数据(可根据需求进行其他处理)</span>
        <span class="token keyword">const</span> datas <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'jack'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'rose'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">21</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'lily'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> resData <span class="token operator">=</span> datas<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> ele<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token operator">+</span>query<span class="token punctuation">.</span>id <span class="token comment">//+,隐式转换</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// - 例如，希望给响应数据中添加一些信息</span>
        resData <span class="token operator">=</span> <span class="token punctuation">{</span>
            status<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
            msg<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
            data<span class="token operator">:</span> resData<span class="token punctuation">,</span>
            time<span class="token operator">:</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// 将数据响应给客户端</span>
        <span class="token comment">//  - 设置响应头告诉客户端响应的数据是JSON格式</span>
        res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//  - 将数据转换为JSON格式的字符串再响应</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>resData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Not Found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 用来监听端口</span>
    <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听8000端口成功...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><ul><li>req.method   可以判断请求的类型, 请求方式 (大写名称，判断时需要注意)</li> <li>res.end()的参数只能是字符串，而不能是对象</li></ul> <h3 id="_9-2-url模块"><a href="#_9-2-url模块" class="header-anchor">#</a> 9.2. url模块</h3> <ul><li>文档地址：http://nodejs.cn/api/url.html</li> <li>node.js中的一个核心模块，用于进行url地址处理,对用户输入的url进行解析，进而得到各种信息。</li></ul> <p><code>步骤：</code></p> <ul><li><p>引入</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>使用它的方法</p> <ul><li>obj = url.parse(地址栏中输入的url)</li></ul></li></ul> <p><code>示例:</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>http://itcast.cn:80/schools/students?id=18&amp;name=zs#photo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> urlobj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// urlobj对象中，就有我们需要的信息</span>
urlobj<span class="token punctuation">.</span>pathname <span class="token operator">:</span><span class="token function">获取用户输入的url的路径名</span> <span class="token punctuation">(</span><span class="token string">'/schools/students'</span><span class="token punctuation">)</span>
urlobj<span class="token punctuation">.</span>search<span class="token operator">:</span> <span class="token string">'?id=18&amp;name=zs'</span><span class="token punctuation">,</span>
urlobj<span class="token punctuation">.</span>query<span class="token operator">:</span> <span class="token function">获取用户输入的url中的查询字符串</span><span class="token punctuation">(</span> <span class="token string">'id=18&amp;name=zs'</span> <span class="token punctuation">)</span>
urlobj<span class="token punctuation">.</span>path<span class="token operator">:</span> <span class="token string">'/schools/students?id=18&amp;name=zs'</span><span class="token punctuation">,</span>
urlobj<span class="token punctuation">.</span>href<span class="token operator">:</span> <span class="token string">'/schools/students?id=18&amp;name=zs'</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>urlobj.query获得了传递的全部参数，一般还需从地址栏中分析传递的数据。即从地址中分析出id和name的值来。</p> <h3 id="_9-3-querystring模块"><a href="#_9-3-querystring模块" class="header-anchor">#</a> 9.3. querystring模块</h3> <ul><li><p>文档地址：https://nodejs.org/api/querystring.html#querystring_querystring_parse_str_sep_eq_options</p></li> <li><p>node中的一个核心模块，用来对url编码格式的数据进行转换处理，对url中的查询字符串这部分进行处理。</p></li> <li><p>可以将url编码格式的字符串转换为对象结构</p></li> <li><p>url.parse()的参数2为true，就是让url调用了querystring进行处理</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> qs<span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> pathname<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> queryString<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_9-4-post接口"><a href="#_9-4-post接口" class="header-anchor">#</a> 9.4. post接口</h3> <p><code>HTTP协议组成：</code></p> <ul><li>请求报文:
<ul><li>请求行： GET请求的请求参数在地址后面用?连接传递</li> <li>请求头</li> <li>空行</li> <li>请求体：
<ul><li>POST请求的请求参数在请求体中传递</li> <li>GET请求的请求体为空</li></ul></li></ul></li></ul> <blockquote><p>post类型与get类型的接口区别较大，主要在两个方面：</p></blockquote> <ol><li><p>类型不同</p> <p>对于类型不同还比较好判断，可以通过 req.method 来获取</p></li> <li><p>传参不同</p> <ul><li>get请求参数在请求行中（附加在url后面）</li> <li>post请求参数在请求体中</li></ul></li></ol> <ul><li>对于获取post参数就相对复杂一些，主要是用到request对象的两个事件data,end。</li> <li>post的请求参数体积通常比get要大，需要使用数据，进行参数接收</li></ul> <p><code>基本流程：</code></p> <ul><li>在req对象上添加两个事件，用来收集参数
<ul><li>data事件,req.on(&quot;data&quot;,function(tempData){ })
<ul><li>数据传输过程中会多次触发data事件，回调函数也会相应的执行一次。其中的tempData是一个形参，表示每次接收到数据中的一小部分(每段内容都是buffer格式)，需要将所有数据接收完毕，并拼接在一起。</li></ul></li> <li>end事件，数据传输完毕时触发的事件，如果要使用请求参数，只能在end中进行操作
<ul><li>req.on(&quot;end&quot;,function(){})</li></ul></li></ul></li> <li>解析参数
<ul><li>queryString</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入http模块</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入querystring模块</span>
<span class="token keyword">const</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2 创建web服务器实例</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 3 进行post请求的处理操作</span>
    <span class="token comment">//  3.1 判断请求地址和请求类型</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/admin/addCate'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 3.2 接收post请求参数</span>
        <span class="token comment">//   - 给req设置两个事件 data end</span>
        <span class="token keyword">let</span> dataStr <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">tempData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            dataStr <span class="token operator">+=</span> tempData<span class="token punctuation">;</span>        <span class="token comment">//tempData表示每次接收到数据中的一小部分,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 在end中使用接收完毕的所有请求参数</span>
            <span class="token comment">// 调用querystring模块的parse()将dataStr转换为对象</span>
            <span class="token keyword">let</span> dataObj <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>dataStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 根据具体需求进行数据处理，处理后进行响应即可</span>
            res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dataObj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'监听8000...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>在发post请求时，传递的数据会在请求体中，它也是字符串格式，并且是一点一点上传到web服务器的，每上传一部分就会触发data事件，而最后全部上传完成之后，会触发end事件。</li></ul> <h2 id="_10-自定义模块"><a href="#_10-自定义模块" class="header-anchor">#</a> 10. 自定义模块</h2> <ul><li>自己写的模块就是自定义模块。</li> <li>在node.js中 ，对代码的封装是以模块（一个一个的文件）为单位进行的。</li> <li>一般的做法是实现好某一个功能之后，封装成一个模块，然后在其它文件中使用这个模块。
<ul><li>使用一个模块，就是在一个js文件中去使用另一个js文件中定义的变量，常量，函数....</li></ul></li></ul> <h3 id="_10-1-基本使用"><a href="#_10-1-基本使用" class="header-anchor">#</a> 10.1. 基本使用</h3> <ol><li>定义模块</li></ol> <p>新建一个js文件，用模块名给它命名。例如，模块叫myModule，则这个js文件最好叫myModule.js</p> <ol start="2"><li>导出模块</li></ol> <p>在myModule.js内部，定义一些函数，变量，根据业务要求做一些不同的工作。最后根据情况导出这些函数，变量。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//myModule.js</span>
<span class="token keyword">const</span> myPI <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 通过module.exports来导出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    myPI<span class="token punctuation">,</span>
    add
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意：</p> <ul><li>module.exports 是固定写法，一般放在文件的最末尾，也只用一次。</li> <li>module.exports表示当前模块要暴露给其它模块的功能。当然不须要把所有在模块中定义的函数都暴露出来。</li></ul> <ol start="3"><li>引入模块</li></ol> <p>在需要使用模块的文件中，使用require语句引入定义好的模块，注意使用相对路径。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> myModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./myModule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>require()是用来引入模块的。注意使用自定义模块时，使用相对路径，而使用核心模块时，不需要写路径。</p> <ol start="4"><li>使用模块</li></ol> <p>当一个模块被成功引入之后，就可以按使用核心模块的过程一样去使用它们了。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> myModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./myModule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 在使用之前请先打印出来看看。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myModule<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> rs <span class="token operator">=</span> myModule<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_10-2-导出模块的两种方式"><a href="#_10-2-导出模块的两种方式" class="header-anchor">#</a> 10.2. 导出模块的两种方式</h3> <p>在自定义模块过程中，有两种导出模块内容的方式：</p> <ul><li>exports</li> <li>module.exports</li></ul> <p>参考：https://nodejs.org/api/modules.html#modules_exports_shortcut</p> <ul><li>它们的关系是：  exports是module.exports的别名，即：</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>exports <span class="token operator">===</span> module<span class="token punctuation">.</span>exports
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>所以下面两种写法的效果是一样的：</p> <blockquote><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1 mymodule.js</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>
exports<span class="token punctuation">.</span>pi <span class="token operator">=</span> <span class="token number">3.1415926</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//2 mymodule.js</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>pi <span class="token operator">=</span> <span class="token number">3.1415926</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></blockquote> <p>区别在于：</p> <ul><li>在引入某模块时，以该模块中module.exports指向的内容为准。</li> <li>在定义模块时：
<ul><li>在初始时，exports和module.exports是指向同一块内存区域，其内容都是一个空对象。</li> <li>如果直接给exports对象赋值（例如：exports={a:1,b:2}），此时，exports就不会再指向module.exports，而转而指向这个新对象，此时，exports与module.exports不是同一个对象。</li> <li>在引入模块时，是以模块的中的module.exports为准，因此，此时写在exports上的对象是无法导出的。</li></ul></li> <li>在导出模块过程中，建议只用一种方式（建议直接使用module.exports）。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//a.js</span>
<span class="token keyword">let</span> username <span class="token operator">=</span> <span class="token string">'jack'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userAge <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'呵呵呵'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//   - 如果希望当前模块中的某些数据可以被其他模块使用，需要进行特殊操作</span>
<span class="token comment">//   - 操作方式称为： 暴露 或者 导出</span>

<span class="token comment">// 导出的方式: (选择其中一种使用即可)</span>
<span class="token comment">//  - 方式1：(默认方式)</span>
<span class="token comment">//    - 如果要导出的数据很多时，推荐使用第一种形式</span>
<span class="token comment">//    - 如果突然分不清两者的关系了，全用第一种肯定没错</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  username<span class="token punctuation">,</span>
  userAge<span class="token punctuation">,</span>
  sayHi
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// module.exports.name = 'jack'; // 也可以这样写</span>

<span class="token comment">//  - 方式2：(简写)</span>
<span class="token comment">//    - 方式2的exports其实是复制了方式一的module.exports</span>
<span class="token comment">//    - 如果要导出的属性较少，可以使用第二种方式</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'jack'</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span> 
<span class="token comment">// 一定不要给exports进行赋值操作，会切断与module.exports的引用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//main.js</span>
<span class="token comment">// 设置自定义模块a.js，将a.js引入到主模块main.js中进行使用</span>

<span class="token comment">// 引入自定义模块a.js （或直接称为a模块也行）</span>
<span class="token comment">//  - 注意：自定义模块必须采用路径书写形式进行引入</span>
<span class="token comment">//  - require()的返回值就是模块中的 module.exports这个对象</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_11-npm使用"><a href="#_11-npm使用" class="header-anchor">#</a> 11. npm使用</h2> <p>node.js通过自带的<code>npm</code>(node package manager)工具来管理第三方模块</p> <ul><li><code>npm</code> 全称 <code>Node Package Manager</code>(node 包管理器)，它的诞生是为了解决 Node 中第三方包共享的问题。</li> <li><code>npm</code> 不需要单独安装。在安装Node的时候，会连带一起安装<code>npm</code>。</li> <li>[官网]<strong>(https://www.npmjs.com/)</strong></li></ul> <blockquote><p>当谈到npm时，在说两个东西：</p></blockquote> <ul><li>命令行工具。这个工具在安装node时，已经自动安装过了。</li> <li>npm网站。这是一个第三方模块的&quot;超市&quot;，可以自由地下载，上传模块。</li></ul> <h3 id="_11-1-包（package）与模块关系"><a href="#_11-1-包（package）与模块关系" class="header-anchor">#</a> 11.1. 包（package）与模块关系</h3> <img src="https://jiyaning.github.io/staticImgs/images/包与模块的关系.png"> <ul><li>node.js中一个模块就是一个单独的js文件</li></ul> <ul><li><strong>包是多个模块的集合</strong>。一个模块能够解决的问题比较单一，一个包中有多个模块。</li> <li>npm 管理的单位就是包</li></ul> <h3 id="_11-2-通过npm命令行下载第三方模块（包）"><a href="#_11-2-通过npm命令行下载第三方模块（包）" class="header-anchor">#</a> 11.2. 通过npm命令行下载第三方模块（包）</h3> <ol><li>初始化项目</li></ol> <p>进入到项目所在的根目录下，启动小黑窗（按下shift键，点击右键，在弹出的菜单中选择 在此处打开命令行）</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>npm init <span class="token operator">--</span>yes
<span class="token comment">// 或者是 npm init -y</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>init命令用来在根目录下生成一个package.json文件，这个文件中记录了当前项目的基本信息。它是一切工作的开始。</p> <ol start="2"><li>安装包</li></ol> <ul><li>生成了package.json文件之后，就可以来安装第三方包了。在npm官网中，有上百万个包，供我们使用。</li> <li><strong>npm install 包名</strong></li></ul> <h3 id="_11-3-npm-init-命令"><a href="#_11-3-npm-init-命令" class="header-anchor">#</a> 11.3. npm init 命令</h3> <p>在某个目录下开启小黑窗，输入如下命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm init 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>它会启动一个交互式的程序，让你填入一些关于本项目的信息。最后会生成一个package.json文件。</p> <p>如果你希望直接采用默认信息，可以使用:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>npm init <span class="token operator">--</span>yes
<span class="token comment">// 或者是 npm init -y</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>这个命令只需要运行一次，它的目的仅仅是生成一个package.json文件。而这个package.json文件在后期是可以手动修改的。</li> <li>如果项目根目录下已经有了package.json文件，就不需要再去运行这个命令了</li> <li>一般我们从网上clone下来的项目都会包含这个文件。</li></ul> <p><code>package.json文件:</code></p> <p>它整体是一个json字符串，对当前项目的整体描述。其中最外层可以看作是一个js的对象（每一个属性名都加了&quot;&quot;，这就是一个典型的json标记）。这个文件中有非常多的内容，目前学习如下几个：</p> <ul><li>name    项目的名字。如是它是一个第三方包的话，它就决定了我们在require()时应该要写什么内容</li> <li>version       版本号</li></ul> <h3 id="_11-4-node-modules文件夹"><a href="#_11-4-node-modules文件夹" class="header-anchor">#</a> 11.4. node_modules文件夹</h3> <p>这个文件夹中保存着从npm中下载来的第三方包。在使用npm install 命令时，会修改这个文件夹中的内容。具体如下来说，当键入<code>npm install XXX</code>之后：</p> <ol><li><p>如果有package.json</p> <p>(1) 修改package.json文件。根据开发依赖和生产依赖的不同，决定把这句记录在加在devDependencies或者是dependencies列表中。</p> <p>(2) 修改node_modules文件夹</p> <ol><li>如果有node_modules文件夹，则直接在下面新建名为XXX的文件夹，并从npm中下来这个包</li> <li>如果没有node_modules，则先创建这个文件夹，再去下载相应的包</li></ol></li> <li><p>如果没有package.json。会给一个警告信息</p></li></ol> <p><code>说明：</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- 建议先创建package.json之后，再去install
- 在分享代码时，一般不需要把node_modules也给别人。
- 对方拿到代码之后，先运行`npm install`(后面不接任何的包名)，自己去安装这些个依赖包。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_11-5-全局安装包和本地安装包"><a href="#_11-5-全局安装包和本地安装包" class="header-anchor">#</a> 11.5 全局安装包和本地安装包</h3> <p>通过<code>npm install</code> 命令来安装包，简单说就是把包从npm的官网上下载到自己的电脑中。具体这个包下载到哪里了，还是有一点讲究的。</p> <p>分成两类：</p> <ul><li>全局安装: 包被安装到了系统目录（一般在系统盘的node_modules中），本机都可以使用。
<ul><li>命令：<code>npm install -g 包名</code></li></ul></li> <li>局部安装（或者叫本地安装)，包安装在当前项目的根目录下，与package.json同级目录的node_modules。就只在这个项目中可以使用。
<ul><li>命令：<code>npm install 包名</code></li></ul></li></ul> <p><code>全局包与本地包的区别:</code></p> <ul><li><p>全局安装的包一般可提供直接执行的命令。通过对一些工具类的包采用这种方式安装，如：</p> <p>gulp, nodemon, live-server,nrm等。</p></li> <li><p>本地安装的包是与具体的项目有关的， 需要在开发过程中使用这些具体的功能。</p></li></ul> <p>一个经验法则：</p> <ul><li>要用到该包的命令执行任务的就需要全局安装</li> <li>要通过require引入使用的就需要本地安装</li></ul> <h3 id="_11-6-全局安装nrm包"><a href="#_11-6-全局安装nrm包" class="header-anchor">#</a> 11.6. 全局安装nrm包</h3> <ul><li><p>因为下载包时，默认是从npm官网（国外的网站）下载，速度可能会比较慢。在npm有一个工具可以来手动设置从哪里去下载包。这个工具就是nrm。这个工具是帮助我们切换安装包的来源的，不应该只限于某个具体的项目，所以我们采用全局安装的方式来安装它。</p></li> <li><p>nrm包的地址：<a href="https://www.npmjs.com/package/nrm" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/nrm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>nrm的使用方法。</p></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 第一步： 全局安装 </span>
npm install nrm <span class="token operator">-</span>g

<span class="token comment">// 第二步：列出所有的源信息</span>
<span class="token comment">// （*）标注的就是当前使用的源</span>
nrm ls

<span class="token comment">// 第三步：根据需要切换源 </span>
<span class="token comment">// 例如：指定使用taobao源</span>
nrm use taotao
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_11-7-require的加载机制"><a href="#_11-7-require的加载机制" class="header-anchor">#</a> 11.7. require的加载机制</h3> <p>在使用一个模块时，会使用require命令来加载这个模块。以加载一个自定义模块为例，require(文件名)的效果是：</p> <ol><li>执行这个文件中的代码</li> <li>把这个文件中的module.exports对象中的内容返回出来。</li></ol> <p>以如下代码为例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// moudule1.js</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	data<span class="token operator">:</span> c
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>在index.js中使用模块</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./moudule1.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

这里的obj对象就是moudule1<span class="token punctuation">.</span>js中的module<span class="token punctuation">.</span>exports对象
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>require</code> 优先加载<strong>缓存</strong>中的模块</li> <li>如果是<strong>相对路径</strong>，则根据路径加载<strong>自定义模块</strong>，并缓存
<ul><li><code>require('./main')</code>  省略扩展名的情况</li> <li>先加载 <code>main.js</code>，如果没有再加载 <code>main.json</code>，如果没有再加载 <code>main.node</code>(c/c++编写的模块)</li></ul></li> <li>如果不是相对路径，则加载核心模块，并缓存</li> <li>如果不是自定义模块，也不是核心模块，则加载<strong>第三方模块</strong> <ul><li>node 会去本级 node_modules 目录中找</li> <li>如果在 node_modules 目录中找到 <code>moment</code> 目录，则加载该模块并缓存</li> <li>如果过程都找不到，node 则取上一级目录下找 <code>node_modules</code> 目录，规则同上</li> <li>如果一直找到代码文件的文件系统的根路径还找不到，则报错</li></ul></li></ul> <h3 id="_11-8-npm-常用命令"><a href="#_11-8-npm-常用命令" class="header-anchor">#</a> 11.8. npm 常用命令</h3> <ul><li><p>查看</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> --version
<span class="token function">npm</span> -v           // 查看npm 版本
<span class="token function">npm</span> root -g      // 查看全局包的安装目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>升级 npm （npm自己安装自己）</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> <span class="token function">npm</span> --global // 或者
<span class="token function">npm</span> <span class="token function">install</span> <span class="token function">npm</span> -g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>初始化 <code>package.json</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> init -y // 或者
<span class="token function">npm</span> init --yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>安装第三方包</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 安装package.json中列出的所有的包</span>
npm install

<span class="token comment">// 全局安装</span>
npm install 包名 <span class="token operator">-</span>g

<span class="token comment">// 本地安装，没有指定版本，默认安装最新的版本</span>
npm install 包名
<span class="token comment">// 一次安装多个包</span>
npm install 包名<span class="token number">1</span> 包名<span class="token number">2</span> 包名<span class="token number">3</span>
<span class="token comment">// 安装指定版本的包</span>
npm install 包名@版本号

<span class="token comment">// 简写，把install简写成 i</span>
npm i 包名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>删除已安装的包</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> uninstall 本地安装的包名
<span class="token function">npm</span> uninstall -g 全局安装的包名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>清除缓存</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> cache clean -f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h2 id="_12-跨域"><a href="#_12-跨域" class="header-anchor">#</a> 12. 跨域</h2> <p>跨域问题是我们前端开发中经常会遇到的问题，也是面试中的高频题目。</p> <h3 id="_12-1-问题演示"><a href="#_12-1-问题演示" class="header-anchor">#</a> 12.1. 问题演示</h3> <img src="https://jiyaning.github.io/staticImgs/images/chrome跨域插件.gif"> <h3 id="_12-2-实现跨域请求的方案-cors"><a href="#_12-2-实现跨域请求的方案-cors" class="header-anchor">#</a> 12.2. 实现跨域请求的方案--CORS</h3> <p>CORS是一个W3C标准，全称是&quot;跨域资源共享&quot;（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出<a href="http://www.ruanyifeng.com/blog/2012/09/xmlhttprequest_level_2.html" target="_blank" rel="noopener noreferrer"><code>XMLHttpRequest</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>请求，从而克服了AJAX只能<a href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" target="_blank" rel="noopener noreferrer">同源<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>使用的限制。CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10(ie8通过XDomainRequest能支持CORS)。</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>通过在<strong>被请求的路由中</strong>设置header头，可以实现跨域。不过这种方式只从最新的浏览器（IE10）才支持。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/time'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 允许任意源访问，不安全</span>
  <span class="token comment">// res.setHeader('Access-Control-Allow-Origin', '*')</span>
  <span class="token comment">// 允许指定源访问</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'http://www.xxx.com'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>这种方案无需客户端作出任何变化（客户端不用改代码），就当跨域问题不存在一样。</li> <li>服务端响应的时候添加一个 <code>Access-Control-Allow-Origin</code> 的响应头</li> <li>如果ajax请求中还附加了cookie，则还需要设置一句：<code>res.setHeader('Access-Control-Allow-Credentials', 'true');</code></li></ul> <p>自行下载使用 npm cors https://www.npmjs.com/package/cors</p> <h3 id="_12-3-jsonp-vs-cors-对比"><a href="#_12-3-jsonp-vs-cors-对比" class="header-anchor">#</a> 12.3. jsonp vs cors 对比</h3> <p>jsonp：</p> <ul><li>不是ajax</li> <li>只能使用<code>get方式</code>传参</li> <li>兼容性好</li></ul> <p>cors:</p> <ul><li>就是ajax</li> <li>支持各种方式的请求(post,get....)</li> <li>浏览器的支持不好</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.549ab972.js" defer></script><script src="/assets/js/2.ecc2fa6f.js" defer></script><script src="/assets/js/23.cce2bed4.js" defer></script>
  </body>
</html>
